[{"name":"app.R","content":"library(shiny)\r\nlibrary(ggplot2)\r\nlibrary(dplyr)\r\n\r\n## R 내장 데이터셋\r\nbuiltin_data <- list(자동차 = cars |> set_names(c(\"속도\", \"거리\")))\r\n\r\n## 범주형 데이터셋\r\nset.seed(123) # 재현 가능한 결과를 위해 시드 설정\r\n\r\ngender <- sample(c(\"남성\", \"여성\"), 10, replace = TRUE)\r\nage_group <- sample(c(\"10대\", \"20대\", \"30대\", \"40대\", \"50대 이상\"), 10, replace = TRUE)\r\nregion <- sample(c(\"서울\", \"경기\", \"충청\", \"전라\", \"경상\", \"강원\", \"제주\"), 10, replace = TRUE)\r\n\r\ncategory_data <- data.frame(\r\n  성별 = as.factor(gender),\r\n  연령대 = as.factor(age_group),\r\n  거주지역 = as.factor(region)\r\n)\r\n\r\n## 데이터셋 결합\r\ndatasets <- c(builtin_data, list(인적정보 = category_data))\r\n\r\nlibrary(shiny)\r\nlibrary(ggplot2)\r\nlibrary(dplyr)\r\n\r\n# 0. 데이터셋 ---------------------------------------------------------------\r\n## R 내장 데이터셋\r\nbuiltin_data <- list(자동차 = cars |> set_names(c(\"속도\", \"거리\")))\r\n\r\n## 범주형 데이터셋\r\nset.seed(123) # 재현 가능한 결과를 위해 시드 설정\r\n\r\ngender <- sample(c(\"남성\", \"여성\"), 10, replace = TRUE)\r\nage_group <- sample(c(\"10대\", \"20대\", \"30대\", \"40대\", \"50대 이상\"), 10, replace = TRUE)\r\nregion <- sample(c(\"서울\", \"경기\", \"충청\", \"전라\", \"경상\", \"강원\", \"제주\"), 10, replace = TRUE)\r\n\r\ncategory_data <- data.frame(\r\n  성별 = as.factor(gender),\r\n  연령대 = as.factor(age_group),\r\n  거주지역 = as.factor(region)\r\n)\r\n\r\n## 데이터셋 결합\r\ndatasets <- c(builtin_data, list(고객정보 = category_data))\r\n\r\n# 1. UI ---------------------------------------------------------------\r\nui <- fluidPage(\r\n  titlePanel(\"기술통계\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      selectInput(\"dataset\", \"데이터셋 선택\", choices = names(datasets)),\r\n      uiOutput(\"var_select\")\r\n    ),\r\n    mainPanel(\r\n      fluidRow(\r\n        column(6, plotOutput(\"plot_bar\")),\r\n        column(6, plotOutput(\"plot_pie\"))\r\n      ),\r\n      uiOutput(\"summary\")\r\n    )\r\n  )\r\n)\r\n\r\n# 2. 서버 ---------------------------------------------------------------\r\nserver <- function(input, output, session) {\r\n  data <- reactive({\r\n    datasets[[input$dataset]]\r\n  })\r\n\r\n  output$var_select <- renderUI({\r\n    selectInput(\"var\", \"변수 선택\", choices = names(data()))\r\n  })\r\n\r\n  output$plot_bar <- renderPlot({\r\n    req(input$var)\r\n    if (is.factor(data()[[input$var]])) {\r\n      ggplot(data(), aes_string(x = input$var)) +\r\n        geom_bar(fill = \"skyblue\", color = \"white\") +\r\n        labs(title = \"막대 그래프\", x = input$var, y = \"빈도\") +\r\n        theme_minimal()\r\n    } else if (is.numeric(data()[[input$var]])) {\r\n      ggplot(data(), aes_string(x = input$var)) +\r\n        geom_histogram(fill = \"skyblue\", color = \"white\", bins = 30) +\r\n        labs(title = \"히스토그램\", x = input$var, y = \"빈도\") +\r\n        theme_minimal()\r\n    }\r\n  })\r\n\r\n  output$plot_pie <- renderPlot({\r\n    req(input$var)\r\n    if (is.factor(data()[[input$var]])) {\r\n      freq_table <- summary(data()[[input$var]])\r\n      pie_data <- data.frame(\r\n        \"범주\" = names(freq_table),\r\n        \"빈도\" = as.vector(freq_table)\r\n      )\r\n      ggplot(pie_data, aes(x = \"\", y = 빈도, fill = 범주)) +\r\n        geom_bar(stat = \"identity\", width = 1) +\r\n        coord_polar(\"y\", start = 0) +\r\n        labs(title = \"원 그래프\") +\r\n        theme_void()\r\n    } else {\r\n      NULL\r\n    }\r\n  })\r\n\r\n  freq_df <- reactive({\r\n    req(input$var)\r\n    if (is.factor(data()[[input$var]])) {\r\n      freq_table <- summary(data()[[input$var]])\r\n      freq_df <- data.frame(\r\n        \"범주\" = names(freq_table),\r\n        \"빈도\" = as.vector(freq_table),\r\n        check.names = FALSE\r\n      )\r\n      total <- sum(freq_df$빈도)\r\n      freq_df$비율 <- paste0(round(freq_df$빈도 / total * 100, 2), \"%\")\r\n      freq_df <- rbind(freq_df, c(\"총합\", total, \"100%\"))\r\n      freq_df\r\n    }\r\n  })\r\n\r\n  output$summary <- renderUI({\r\n    req(input$var)\r\n    if (is.factor(data()[[input$var]])) {\r\n      table_output <- tableOutput(\"freq_table\")\r\n      bootstrapPage(\r\n        fluidRow(\r\n          column(12,\r\n                 h4(\"범주형 변수 요약\"),\r\n                 table_output\r\n          )\r\n        )\r\n      )\r\n    } else if (is.numeric(data()[[input$var]])) {\r\n      x <- data()[[input$var]]\r\n      summary_output <- renderPrint({\r\n        list(\r\n          \"평균\" = mean(x),\r\n          \"중앙값\" = median(x),\r\n          \"최솟값\" = min(x),\r\n          \"최댓값\" = max(x),\r\n          \"범위\" = max(x) - min(x),\r\n          \"분산\" = var(x),\r\n          \"표준편차\" = sd(x)\r\n        )\r\n      })\r\n      bootstrapPage(\r\n        fluidRow(\r\n          column(12,\r\n                 h4(\"연속형 변수 요약\"),\r\n                 summary_output\r\n          )\r\n        )\r\n      )\r\n    }\r\n  })\r\n\r\n  output$freq_table <- renderTable({\r\n    freq_df()\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
