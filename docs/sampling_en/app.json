[{"name":"app.R","content":"library(shiny)\r\nlibrary(ggplot2)\r\nlibrary(ggforce)\r\nlibrary(dplyr)\r\n\r\n\r\nui <- fluidPage(\r\n  titlePanel(\"모집단에서 표본 추출\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      sliderInput(\"sample_size\", \"표본 크기\", min = 1, max = 100, value = 10),\r\n      verbatimTextOutput(\"sample_summary\")\r\n    ),\r\n    mainPanel(\r\n      plotOutput(\"population_plot\"),\r\n      plotOutput(\"sample_plot\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output) {\r\n  set.seed(123)\r\n  n <- 100\r\n  angles <- runif(n, 0, 2*pi)\r\n  radii <- sqrt(runif(n, 0, 1))\r\n  x <- radii * cos(angles)\r\n  y <- radii * sin(angles)\r\n  population <- tibble(x = x, y = y) %>%\r\n    mutate(gender = c(rep(\"남자\", 50), rep(\"여자\", 50)))\r\n\r\n  output$population_plot <- renderPlot({\r\n    ggplot(population) +\r\n      geom_point(aes(x, y, color = gender), size = 3) +\r\n      geom_circle(aes(x0 = 0, y0 = 0, r = 1), color = \"gray30\") +\r\n      theme_void() +\r\n      scale_color_manual(values = c(\"여자\" = \"red\", \"남자\" = \"blue\")) +\r\n      theme(legend.position = \"top\") +\r\n      coord_fixed() +\r\n      labs(title = \"모집단\", color = \"성별\")\r\n  })\r\n\r\n  sample <- reactive({\r\n    population %>%\r\n      sample_n(input$sample_size, replace = FALSE)\r\n  })\r\n\r\n  output$sample_plot <- renderPlot({\r\n    ggplot(sample()) +\r\n      geom_point(aes(x, y, color = gender), size = 3) +\r\n      geom_circle(aes(x0 = 0, y0 = 0, r = 1), color = \"gray30\") +\r\n      theme_void() +\r\n      scale_color_manual(values = c(\"여자\" = \"red\", \"남자\" = \"blue\")) +\r\n      theme(legend.position = \"top\") +\r\n      coord_fixed() +\r\n      labs(title = \"추출된 표본\", color = \"성별\")\r\n  })\r\n\r\n  output$sample_summary <- renderText({\r\n    male_count <- sum(sample()$gender == \"남자\")\r\n    female_count <- sum(sample()$gender == \"여자\")\r\n    paste(\"추출된 표본 요약:\\n\",\r\n          \"남자:\", male_count, \"명\\n\",\r\n          \"여자:\", female_count, \"명\")\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
